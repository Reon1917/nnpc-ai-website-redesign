---
import Layout from "../layouts/main.astro";
import heroImage from "../assets/hero-image/nnpc_hero_img_3.png";
import companyLogo from "../assets/company-logos/ccEnterprise.png";
import { getEntry } from "astro:content";
import type { CollectionEntry } from "astro:content";

type HomeEntry = CollectionEntry<"home">;
type HomeData = HomeEntry["data"];
type HomeSection = HomeData["section"];
type HomeDataBySection<T extends HomeSection> = Extract<HomeData, { section: T }>;
type HomeEntryBySection<T extends HomeSection> = Omit<HomeEntry, "data"> & {
	data: HomeDataBySection<T>;
};

const getHomeEntry = async <T extends HomeSection>(section: T) => {
	const entry = await getEntry("home", section);
	if (!entry) {
		throw new Error(`Missing home ${section} content.`);
	}
	if (entry.data.section !== section) {
		throw new Error(`Mismatched home ${section} content.`);
	}
	return entry as HomeEntryBySection<T>;
};

const heroEntry = await getHomeEntry("hero");
const { Content: HeroContent } = await heroEntry.render();
const hero = heroEntry.data;

const aboutEntry = await getHomeEntry("about");
const { Content: AboutContent } = await aboutEntry.render();
const about = aboutEntry.data;

const partnersEntry = await getHomeEntry("partners");
const partners = partnersEntry.data;

const industriesEntry = await getHomeEntry("industries");
const industries = industriesEntry.data;

const consultationEntry = await getHomeEntry("consultation");
const consultation = consultationEntry.data;

const footerEntry = await getHomeEntry("footer");
const footer = footerEntry.data;

---

<Layout title="NNPC AI - Industrial Automation & Intelligence">
	<div class="nnpc-page">
		<header class="nnpc-hero">
			<img
				class="nnpc-hero-media"
				src={heroImage.src}
				width={heroImage.width}
				height={heroImage.height}
				alt=""
				loading="eager"
				decoding="async"
				aria-hidden="true"
			/>
			<div class="nnpc-hero-overlay" aria-hidden="true"></div>
			<div class="nnpc-hero-inner relative z-10 mx-auto flex w-full max-w-6xl items-center justify-center px-6 py-12">
				<div class="nnpc-hero-main space-y-5 text-center" data-reveal>
					<p class="text-xs uppercase tracking-[0.4em] text-amber-800">
						{hero.eyebrow}
					</p>
					<h1 class="font-display text-5xl leading-tight text-neutral-900 md:text-6xl">
						{hero.title}
					</h1>
					<p class="text-lg font-semibold text-amber-800 md:text-xl">
						{hero.lead}
					</p>
					<div class="text-base text-neutral-700 md:text-lg">
						<HeroContent />
					</div>
					<div class="flex flex-wrap justify-center gap-4">
						<a class="nnpc-btn nnpc-btn-primary" href="#consultation">
							{hero.ctaPrimary}
						</a>
						<a class="nnpc-btn nnpc-btn-outline" href="#industries">
							{hero.ctaSecondary}
						</a>
					</div>
				</div>
			</div>
		</header>

		<section class="nnpc-section nnpc-section-light" id="about">
			<div class="mx-auto grid max-w-6xl gap-8 px-6 py-14 lg:grid-cols-[1.05fr_0.95fr]">
				<div class="space-y-4" data-reveal>
					<p class="text-xs uppercase tracking-[0.35em] text-neutral-600">
						{about.eyebrow}
					</p>
					<h2 class="font-display text-4xl text-neutral-900">
						{about.title}
					</h2>
					<div class="space-y-4 text-base text-neutral-600">
						<AboutContent />
					</div>
					<div class="flex items-center gap-3 text-xs uppercase tracking-[0.3em] text-amber-800">
						<span class="nnpc-dot nnpc-dot-dark"></span>
						{about.accent}
					</div>
				</div>
				<div class="relative" data-reveal style="--delay: 140ms;">
					<div class="nnpc-image-frame">
						<div class="nnpc-image-placeholder">
							<span>Image Placeholder</span>
						</div>
					</div>
					<div class="nnpc-caption">{about.caption}</div>
				</div>
			</div>
		</section>

		<section class="nnpc-section" id="partners">
			<div class="mx-auto max-w-6xl px-6 py-14">
				<div class="text-center" data-reveal>
					<p class="text-xs uppercase tracking-[0.35em] text-amber-800">
						{partners.eyebrow}
					</p>
					<h2 class="font-display mt-4 text-4xl text-neutral-900">
						{partners.title}
					</h2>
					<p class="mt-4 text-sm text-neutral-600">
						{partners.description}
					</p>
				</div>

				<div class="mt-8 grid gap-6 md:grid-cols-3">
					{partners.items.map((partner, index) => (
						<article
							class="nnpc-panel flex h-full flex-col gap-5 rounded-2xl p-6"
							data-reveal
							style={`--delay: ${index * 120}ms;`}
						>
							<div class="nnpc-partner-image">
								<div class="nnpc-partner-placeholder">
									<span>{partner.placeholder}</span>
								</div>
							</div>
							<div>
								<h3 class="text-xl font-semibold text-neutral-900">
									{partner.name}
								</h3>
								<p class="mt-1 text-xs uppercase tracking-[0.3em] text-amber-800">
									{partner.role}
								</p>
							</div>
							<p class="text-sm text-neutral-600">{partner.description}</p>
						</article>
					))}
				</div>
			</div>
		</section>

		<section class="nnpc-section nnpc-section-dark" id="industries">
			<div class="nnpc-grid" aria-hidden="true"></div>
			<div class="mx-auto max-w-6xl px-6 py-14">
				<div class="text-center" data-reveal>
					<p class="text-xs uppercase tracking-[0.35em] text-amber-800">
						{industries.eyebrow}
					</p>
					<h2 class="font-display mt-4 text-4xl text-neutral-900">
						{industries.title}
					</h2>
				</div>

				<div class="mt-8 grid gap-6 md:grid-cols-2">
					{industries.items.map((industry, index) => (
						<article
							class="nnpc-industry-card"
							data-reveal
							style={`--delay: ${index * 100}ms;`}
						>
							<h3 class="text-xl font-semibold text-neutral-900">
								{industry.title}
							</h3>
							<div class="mt-5 space-y-4 text-sm text-neutral-700">
								<div>
									<span class="nnpc-label nnpc-label-problem">The Problem</span>
									<p class="mt-2 text-neutral-600">{industry.problem}</p>
								</div>
								<div>
									<span class="nnpc-label nnpc-label-solution">The Solution</span>
									<p class="mt-2 text-neutral-700">{industry.solution}</p>
								</div>
							</div>
						</article>
					))}
				</div>
			</div>
		</section>

		<section class="nnpc-section" id="consultation">
			<div class="mx-auto max-w-5xl px-6 py-14" data-reveal>
				<div class="nnpc-panel rounded-3xl p-6 md:p-8">
					<div class="text-center">
						<p class="text-xs uppercase tracking-[0.35em] text-amber-800">
							{consultation.eyebrow}
						</p>
						<h3 class="font-display mt-4 text-3xl text-neutral-900">
							{consultation.title}
						</h3>
					</div>

					<form
						class="mt-8 grid gap-5 md:grid-cols-2"
						action="#"
						method="POST"
						onsubmit="alert('Thank you. Your request has been simulated.'); return false;"
					>
						<div>
							<label class="nnpc-field-label" for="name">Full Name</label>
							<input
								class="nnpc-field"
								type="text"
								id="name"
								name="name"
								placeholder="John Doe"
								required
							/>
						</div>
						<div>
							<label class="nnpc-field-label" for="company">Company Name</label>
							<input
								class="nnpc-field"
								type="text"
								id="company"
								name="company"
								placeholder="Your Organization"
								required
							/>
						</div>
						<div>
							<label class="nnpc-field-label" for="email">Business Email</label>
							<input
								class="nnpc-field"
								type="email"
								id="email"
								name="email"
								placeholder="john@company.com"
								required
							/>
						</div>
						<div>
							<label class="nnpc-field-label" for="phone">Phone Number</label>
							<input
								class="nnpc-field"
								type="tel"
								id="phone"
								name="phone"
								placeholder="+66"
								required
							/>
						</div>
						<div>
							<label class="nnpc-field-label" for="industry">Your Industry</label>
							<select class="nnpc-field" id="industry" name="industry">
								<option value="" disabled selected>
									Select an industry
								</option>
								<option value="manufacturing">Precision Manufacturing</option>
								<option value="accounting">Accounting &amp; Audit</option>
								<option value="aviation">Aviation &amp; Logistics</option>
								<option value="medical">Medical &amp; Dental</option>
								<option value="estate">Smart Estate</option>
								<option value="other">Other</option>
							</select>
						</div>
						<div>
							<label class="nnpc-field-label" for="interest">Primary Interest</label>
							<select class="nnpc-field" id="interest" name="interest">
								<option value="" disabled selected>
									Select service type
								</option>
								<option value="consulting">Industrial Consulting</option>
								<option value="server">Private AI Server Setup</option>
								<option value="audit">Full Diagnostic Audit</option>
							</select>
						</div>
						<div class="md:col-span-2">
							<label class="nnpc-field-label" for="message">
								Brief Project Details
							</label>
							<textarea
								class="nnpc-field"
								id="message"
								name="message"
								rows="4"
								placeholder="Tell us about your current challenges..."
							></textarea>
						</div>
						<button class="nnpc-btn nnpc-btn-primary md:col-span-2" type="submit">
							Request Consultation
						</button>
					</form>
				</div>
			</div>
		</section>

		<footer class="nnpc-footer">
			<div class="mx-auto max-w-5xl px-6 py-10 text-center">
				<a class="inline-flex items-center justify-center" href="#" aria-label="NNPC AI">
					<img
						src={companyLogo.src}
						width={companyLogo.width}
						height={companyLogo.height}
						alt="Chin Chun Enterprise logo"
						class="h-12 w-auto"
						loading="lazy"
					/>
				</a>
				<p class="mt-4 text-sm text-neutral-600">{footer.blurb}</p>
				<p
					class="mt-4 text-xs uppercase tracking-[0.3em] text-neutral-600"
					set:html={footer.legal}
				></p>
			</div>
		</footer>
	</div>
</Layout>

<style is:global>
	.nnpc-page {
		--gold: #f1c84b;
		--gold-dim: #c9a640;
		--gold-ink: #7a5a08;
		--ink: #141414;
		--ink-deep: #0a0a0a;
		--surface: #ffffff;
		--ivory: #fbf8f1;
		--stone: #d3cbbd;
		background: radial-gradient(
			circle at 20% -15%,
			#fff4d2 0%,
			#f8f3ea 38%,
			#f1ede4 100%
		);
		color: #141414;
	}

	.nnpc-hero {
		position: relative;
		display: flex;
		min-height: 100vh;
		background-color: #f6f2e9;
		isolation: isolate;
	}

	.nnpc-hero-media {
		position: absolute;
		inset: 0;
		width: 100%;
		height: 100%;
		object-fit: cover;
		object-position: center 35%;
		opacity: 1;
		z-index: 0;
	}

	.nnpc-hero-overlay {
		position: absolute;
		inset: 0;
		background: linear-gradient(
			180deg,
			rgba(255, 255, 255, 0.82) 0%,
			rgba(255, 255, 255, 0.55) 45%,
			rgba(247, 242, 232, 0.78) 100%
		);
		z-index: 1;
	}

	.nnpc-hero-inner {
		min-height: 100vh;
		justify-content: center;
	}

	.nnpc-section {
		position: relative;
	}

	.nnpc-section-light {
		background: linear-gradient(135deg, #ffffff 0%, #f5f1e8 100%);
		color: #141414;
	}

	.nnpc-section-dark {
		background: linear-gradient(135deg, #fbf7ee 0%, #f2ede2 100%);
		color: #141414;
	}

	.nnpc-grid {
		position: absolute;
		inset: 0;
		background-image:
			linear-gradient(rgba(10, 10, 10, 0.05) 1px, transparent 1px),
			linear-gradient(90deg, rgba(10, 10, 10, 0.05) 1px, transparent 1px);
		background-size: 40px 40px;
		opacity: 0.25;
		pointer-events: none;
	}

	.nnpc-panel {
		background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(244, 239, 228, 0.85));
		border: 1px solid rgba(14, 14, 14, 0.08);
		box-shadow: 0 20px 45px rgba(24, 18, 5, 0.12);
	}

	.nnpc-hero-main {
		max-width: 44rem;
	}

	.nnpc-hero-main h1 {
		letter-spacing: 0.08em;
		text-transform: uppercase;
		text-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
	}

	.nnpc-btn {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		padding: 0.9rem 2rem;
		border-radius: 0.35rem;
		font-size: 0.75rem;
		font-weight: 700;
		letter-spacing: 0.2em;
		text-transform: uppercase;
		transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
	}

	.nnpc-btn-primary {
		background: var(--gold);
		color: #1d1605;
		box-shadow: 0 15px 35px rgba(241, 200, 75, 0.35);
	}

	.nnpc-btn-primary:hover {
		transform: translateY(-2px);
		box-shadow: 0 20px 45px rgba(241, 200, 75, 0.5);
	}

	.nnpc-btn-outline {
		border: 1px solid rgba(15, 12, 6, 0.25);
		color: #1f1608;
		background: rgba(255, 255, 255, 0.7);
	}

	.nnpc-btn-outline:hover {
		transform: translateY(-2px);
		background: rgba(241, 200, 75, 0.12);
	}

	.nnpc-link {
		color: rgba(30, 26, 18, 0.7);
		transition: color 0.2s ease;
	}

	.nnpc-link:hover {
		color: var(--gold);
	}

	.nnpc-dot {
		width: 0.55rem;
		height: 0.55rem;
		border-radius: 999px;
		background: radial-gradient(circle, rgba(241, 200, 75, 0.95), rgba(241, 200, 75, 0.2));
		box-shadow: 0 0 12px rgba(241, 200, 75, 0.7);
	}

	.nnpc-dot-dark {
		background: radial-gradient(circle, rgba(200, 160, 45, 0.95), rgba(200, 160, 45, 0.2));
		box-shadow: 0 0 12px rgba(200, 160, 45, 0.4);
	}

	.nnpc-highlight {
		color: #1a1a1a;
		background: linear-gradient(120deg, rgba(241, 200, 75, 0.35), rgba(241, 200, 75, 0.35));
		padding: 0 0.2rem;
	}

	.nnpc-image-frame {
		position: relative;
		overflow: hidden;
		border-radius: 1.5rem;
		box-shadow: 0 20px 40px rgba(22, 16, 8, 0.15);
		transform: rotate(-1.5deg);
		transition: transform 0.4s ease;
		background: #fffaf0;
		min-height: 320px;
		display: grid;
		place-items: center;
	}

	.nnpc-image-frame:hover {
		transform: rotate(0deg) scale(1.02);
	}

	.nnpc-image-frame img {
		display: block;
		width: 100%;
		height: auto;
		filter: grayscale(100%);
		transition: filter 0.4s ease;
	}

	.nnpc-image-frame:hover img {
		filter: grayscale(0%);
	}

	.nnpc-image-placeholder {
		display: grid;
		place-items: center;
		width: 100%;
		height: 100%;
		background: linear-gradient(135deg, rgba(241, 200, 75, 0.22), rgba(255, 255, 255, 0.9));
		color: rgba(22, 18, 10, 0.7);
		font-size: 0.75rem;
		letter-spacing: 0.35em;
		text-transform: uppercase;
	}

	.nnpc-caption {
		margin-top: 1rem;
		font-size: 0.7rem;
		letter-spacing: 0.2em;
		text-transform: uppercase;
		color: var(--gold-ink);
	}

	.nnpc-partner-image {
		border-radius: 1rem;
		border: 1px solid rgba(12, 10, 6, 0.08);
		padding: 0.75rem;
		background: rgba(255, 255, 255, 0.7);
		display: flex;
		align-items: center;
		justify-content: center;
		height: 96px;
	}

	.nnpc-partner-image img {
		max-height: 80px;
		width: auto;
		object-fit: contain;
		filter: grayscale(100%);
		opacity: 0.9;
	}

	.nnpc-partner-placeholder {
		width: 100%;
		height: 100%;
		border-radius: 0.85rem;
		border: 1px dashed rgba(14, 12, 8, 0.2);
		display: flex;
		align-items: center;
		justify-content: center;
		color: var(--gold-ink);
		font-size: 0.7rem;
		letter-spacing: 0.3em;
		text-transform: uppercase;
	}

	.nnpc-industry-card {
		background: rgba(255, 255, 255, 0.82);
		border: 1px solid rgba(18, 14, 8, 0.08);
		border-radius: 1.5rem;
		padding: 2rem;
		backdrop-filter: blur(8px);
		box-shadow: 0 15px 30px rgba(20, 16, 10, 0.08);
		transition: transform 0.3s ease, border-color 0.3s ease;
	}

	.nnpc-industry-card:hover {
		transform: translateY(-6px);
		border-color: rgba(241, 200, 75, 0.6);
	}

	.nnpc-label {
		display: inline-flex;
		align-items: center;
		gap: 0.4rem;
		font-size: 0.7rem;
		letter-spacing: 0.2em;
		text-transform: uppercase;
		font-weight: 700;
	}

	.nnpc-label-problem {
		color: #5a4a2a;
	}

	.nnpc-label-solution {
		color: var(--gold-ink);
	}

	.nnpc-field-label {
		display: block;
		font-size: 0.7rem;
		letter-spacing: 0.2em;
		text-transform: uppercase;
		color: rgba(30, 24, 16, 0.7);
		margin-bottom: 0.5rem;
	}

	.nnpc-field {
		width: 100%;
		border-radius: 0.9rem;
		border: 1px solid rgba(18, 14, 8, 0.12);
		background: rgba(255, 255, 255, 0.95);
		padding: 0.9rem 1rem;
		color: #16120a;
		font-size: 0.95rem;
		transition: border-color 0.3s ease, box-shadow 0.3s ease;
	}

	.nnpc-field:focus {
		outline: none;
		border-color: rgba(241, 200, 75, 0.6);
		box-shadow: 0 0 0 3px rgba(241, 200, 75, 0.15);
	}

	select.nnpc-field {
		appearance: none;
		padding-right: 2.5rem;
		background-image:
			linear-gradient(45deg, transparent 50%, rgba(241, 200, 75, 0.7) 50%),
			linear-gradient(135deg, rgba(241, 200, 75, 0.7) 50%, transparent 50%);
		background-position: calc(100% - 18px) 50%, calc(100% - 12px) 50%;
		background-size: 6px 6px, 6px 6px;
		background-repeat: no-repeat;
	}

	.nnpc-footer {
		background: #f7f2e8;
		border-top: 1px solid rgba(18, 14, 8, 0.08);
	}

	[data-reveal] {
		opacity: 0;
		transform: translateY(22px);
		transition: opacity 0.7s ease, transform 0.7s ease;
		transition-delay: var(--delay, 0ms);
	}

	[data-reveal].is-visible {
		opacity: 1;
		transform: translateY(0);
	}

	@media (max-width: 768px) {
		.nnpc-hero,
		.nnpc-hero-inner {
			min-height: 90vh;
		}

		.nnpc-btn {
			width: 100%;
		}

		.nnpc-image-frame {
			min-height: 240px;
			transform: none;
		}
	}

	@media (prefers-reduced-motion: reduce) {
		[data-reveal] {
			animation: none;
			transition: none;
		}
	}
</style>

<script>
	document.addEventListener("DOMContentLoaded", () => {
		const prefersReduced = window.matchMedia(
			"(prefers-reduced-motion: reduce)"
		).matches;
		const revealItems = document.querySelectorAll("[data-reveal]");

		const revealAll = () => {
			revealItems.forEach((item) => item.classList.add("is-visible"));
		};

		if (prefersReduced) {
			revealAll();
			return;
		}

		if ("IntersectionObserver" in window) {
			const observer = new IntersectionObserver(
				(entries, obs) => {
					entries.forEach((entry) => {
						if (entry.isIntersecting) {
							entry.target.classList.add("is-visible");
							obs.unobserve(entry.target);
						}
					});
				},
				{ threshold: 0.2 }
			);

			revealItems.forEach((item) => observer.observe(item));
		} else {
			revealAll();
		}

	});
</script>
